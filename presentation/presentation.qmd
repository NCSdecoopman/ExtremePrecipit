---
title: "Rapport de stage"
subtitle: |
  Caractérisation et évolution\newline
  des précipitations extrêmes horaires\newline 
  en France\newline 
  à partir d’un modèle régional de climat\newline 
  à convection profonde résolue
author:
- Decoopman Nicolas (UGA)\newline
- Juliette Blanchet (IGE, CNRS)\newline
- Antoine Blanc (RTM)
short-author: "Decoopman Nicolas"
institute: "UGA M2 SSD"
lang: fr
date: 2025-08-29
date-format: "D MMMM YYYY"
format:
  beamer:
    execute:
        echo: false        # ne montre pas le code
        warning: false     # masque warnings
        message: false     # masque messages
    theme: Madrid
    classoption: ["10pt"]
    outertheme: infolines
header-includes:
  - |
    \AtBeginDocument{\author[Decoopman Nicolas]{Decoopman Nicolas\\
    Juliette Blanchet (IGE, CNRS)\\
    Antoine Blanc (RTM)}}
  - \usepackage{adjustbox}
---

```{python}
import numpy as np
import pandas as pd
from pathlib import Path

def combined_metrics_df(name_file: str):
    base_dir = Path("../outputs")         # dossier racine à explorer
    csv_paths = list(base_dir.rglob(name_file))

    frames = []
    for path in csv_paths:
        try:
            df = pd.read_csv(path)
            df["source"] = str(path.relative_to(base_dir))  # garder la provenance
            frames.append(df)
        except Exception as exc:                             # CSV illisible
            print(f"⚠️  Fichier ignoré {path}: {exc}")

    if not frames:
        raise SystemExit("Aucun metrics.csv trouvé !")

    # Concaténation puis export
    combined = pd.concat(frames, ignore_index=True)

    # on crée un masque pour les lignes où 'source' contient 'quotidien_reduce'
    mask = combined['source'].str.contains('quotidien_reduce', na=False)

    # on remplace 'quotidien' par 'quotidien_reduce' dans 'echelle' pour ces lignes
    combined.loc[mask & (combined['echelle'] == 'quotidien'), 'echelle'] = 'quotidien_reduce'

    return combined

combined = combined_metrics_df("metrics.csv")
combined_signif = combined_metrics_df("metrics_signif.csv")
combined_signif["col_calculate"] = combined_signif["col_calculate"].astype(str) + "_signif"
combined_all = pd.concat([combined, combined_signif], ignore_index=True)
```

# Contexte

## Réchauffement de la planète

- Plus fort sur les continents que les océans \newline (+1°C monde, +1,7°C France, +2°C Alpes françaises)
- Clausius–Clapeyron (+7%/°C)   
- L'air chaud monte, se refroidit, l'eau se condense sous forme de pluie
  
## En réponse au réchauffement

- Augmentation *théorique* des précipitations extrêmes
- Variable suivant les changements de circulations atmosphériques

## Utilisation de modèles de climat sur de longues périodes

- Tendances durables (changement climatique) *vs.* \newline variations naturelles (variabilité climatique)  
- Modèle numérique **A**pplication of **R**esearch to **O**perations at **ME**soscale  
- **C**onvection-**P**ermitting, **R**egional **C**limate **M**odel (2,5km - 1h) \newline forcer par réanalyse ERA5  

# Méthodologie

![](schema/methodologie.pdf)

# Statistiques descriptives

```{python}
df_jour_pluie = combined.loc[(combined["echelle"] == "quotidien") & (combined["season"] == "hydro") & (combined["col_calculate"] == "numday"), ["n", "r", "me", "delta"]]
df_jour_pluie_reduce = combined.loc[(combined["echelle"] == "quotidien_reduce") & (combined["season"] == "hydro") & (combined["col_calculate"] == "numday"), ["n", "r", "me", "delta"]]
df_mean_pluie_jour = combined.loc[(combined["echelle"] == "quotidien") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean"), ["n", "r", "me", "delta"]]
df_mean_pluie_jour_reduce = combined.loc[(combined["echelle"] == "quotidien_reduce") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean"), ["n", "r", "me", "delta"]]
df_mean_pluie_horaire = combined.loc[(combined["echelle"] == "horaire") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean"), ["n", "r", "me", "delta"]]
df_mean_max_pluie_jour = combined.loc[(combined["echelle"] == "quotidien") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean-max"), ["n", "r", "me", "delta"]]
df_mean_max_pluie_jour_reduce = combined.loc[(combined["echelle"] == "quotidien_reduce") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean-max"), ["n", "r", "me", "delta"]]
df_mean_max_pluie_horaire = combined.loc[(combined["echelle"] == "horaire") & (combined["season"] == "hydro") & (combined["col_calculate"] == "mean-max"), ["n", "r", "me", "delta"]]
```

**Nombre de jours par an de précipitations (1959-2022)** (n = `{python} f'{df_jour_pluie['n'].iloc[0].item()}'`) (HYDRO)

\setlength{\tabcolsep}{0pt}
\begin{columns}[T,totalwidth=\textwidth]
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_numday/quotidien/compare_1/sat_99.9/hydro/mod_norast.pdf}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_numday/quotidien/compare_1/sat_99.9/hydro/obs_norast.pdf}
  \column{0.04\textwidth}\centering\adjustbox{valign=c}{\includegraphics[width=\linewidth]{../outputs/maps/stats_numday/quotidien/compare_1/sat_99.9/legend.pdf}}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_numday/quotidien/compare_1/sat_99.9/hydro/obs_norast_diff.pdf}
  \column{0.04\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_numday/quotidien/compare_1/sat_99.9/legend_diff.pdf}
\end{columns}

r = `{python} f'{df_jour_pluie['r'].iloc[0].item():.2f}'` \newline
Δ (AROME - Stations) de 1959 à 2022 : `{python} f'{df_jour_pluie['me'].iloc[0].item():+.2f}'` jours (`{python} f'{df_jour_pluie['delta'].iloc[0].item():+.2f}'`%) \newline
Δ (AROME - Stations) de 1990 à 2022 : `{python} f'{df_jour_pluie_reduce['me'].iloc[0].item():+.2f}'` jours (`{python} f'{df_jour_pluie_reduce['delta'].iloc[0].item():+.2f}'`%) \newline

**Tendance à déclencher des jours de pluie plus fréquemment que ce qui est observé**

# Statistiques descriptives

**Cumul annuel des précipitations (1959-2022)** (n = `{python} f'{df_mean_pluie_jour['n'].iloc[0].item()}'`) (HYDRO) à l'échelle quotidienne

\setlength{\tabcolsep}{0pt}
\begin{columns}[T,totalwidth=\textwidth]
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/quotidien/compare_1/sat_99.0/hydro/mod_norast.pdf}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/quotidien/compare_1/sat_99.0/hydro/obs_norast.pdf}
  \column{0.04\textwidth}\centering\adjustbox{valign=c}{\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/quotidien/compare_1/sat_99.0/legend.pdf}}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/quotidien/compare_1/sat_99.0/hydro/obs_norast_diff.pdf}
  \column{0.04\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/quotidien/compare_1/sat_99.0/legend_diff.pdf}
\end{columns}

r = `{python} f'{df_mean_pluie_jour['r'].iloc[0].item():.2f}'` \newline
Δ (AROME - Stations) de 1959 à 2022 : `{python} f'{df_mean_pluie_jour['me'].iloc[0].item():+.2f}'` mm/an (`{python} f'{df_mean_pluie_jour['delta'].iloc[0].item():+.2f}'`%) \newline
Δ (AROME - Stations) de 1990 à 2022 : `{python} f'{df_mean_pluie_jour_reduce['me'].iloc[0].item():+.2f}'` mm/an (`{python} f'{df_mean_pluie_jour_reduce['delta'].iloc[0].item():+.2f}'`%) \newline

**Répartition correcte de la quantité totale d'eau**

# Statistiques descriptives

**Cumul annuel des précipitations (1990-2022)** (n = `{python} f'{df_mean_pluie_horaire['n'].iloc[0].item()}'`) (HYDRO) à \newline l'échelle horaire

\setlength{\tabcolsep}{0pt}
\begin{columns}[T,totalwidth=\textwidth]
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/horaire/compare_1/sat_99.0/hydro/mod_norast.pdf}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/horaire/compare_1/sat_99.0/hydro/obs_norast.pdf}
  \column{0.04\textwidth}\centering\adjustbox{valign=c}{\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/horaire/compare_1/sat_99.0/legend.pdf}}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/horaire/compare_1/sat_99.0/hydro/obs_norast_diff.pdf}
  \column{0.04\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean/horaire/compare_1/sat_99.0/legend_diff.pdf}
\end{columns}

r = `{python} f'{df_mean_pluie_horaire['r'].iloc[0].item():.2f}'` \newline
Δ (AROME - Stations) de 1990 à 2022 : `{python} f'{df_mean_pluie_horaire['me'].iloc[0].item():+.2f}'` mm/an (`{python} f'{df_mean_pluie_horaire['delta'].iloc[0].item():+.2f}'`%) \newline

**Résultats semblables**

# Pluies plus fréquentes en plus faibles quantités

![](schema/bilan-1.pdf)

# Statistiques descriptives

**Moyenne des maxima journaliers des précipitations (1959-2022)** (n = `{python} f'{df_mean_max_pluie_jour['n'].iloc[0].item()}'`) (HYDRO)

\setlength{\tabcolsep}{0pt}
\begin{columns}[T,totalwidth=\textwidth]
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/quotidien/compare_5/sat_99.0/hydro/mod_norast.pdf}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/quotidien/compare_5/sat_99.0/hydro/obs_norast.pdf}
  \column{0.04\textwidth}\centering\adjustbox{valign=c}{\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/quotidien/compare_5/sat_99.0/legend.pdf}}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/quotidien/compare_5/sat_99.0/hydro/obs_norast_diff.pdf}
  \column{0.04\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/quotidien/compare_5/sat_99.0/legend_diff.pdf}
\end{columns}

r = `{python} f'{df_mean_max_pluie_jour['r'].iloc[0].item():.2f}'` \newline
Δ (AROME - Stations) de 1959 à 2022 : `{python} f'{df_mean_max_pluie_jour['me'].iloc[0].item():+.2f}'` mm/j (`{python} f'{df_mean_max_pluie_jour['delta'].iloc[0].item():+.2f}'`%) \newline
Δ (AROME - Stations) de 1990 à 2022 : `{python} f'{df_mean_max_pluie_jour_reduce['me'].iloc[0].item():+.2f}'` mm/j (`{python} f'{df_mean_max_pluie_jour_reduce['delta'].iloc[0].item():+.2f}'`%) \newline

# Statistiques descriptives

**Moyenne des maxima horaires des précipitations (1990-2022)** (n = `{python} f'{df_mean_max_pluie_horaire['n'].iloc[0].item()}'`) (HYDRO)

\setlength{\tabcolsep}{0pt}
\begin{columns}[T,totalwidth=\textwidth]
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/horaire/compare_5/sat_99.0/hydro/mod_norast.pdf}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/horaire/compare_5/sat_99.0/hydro/obs_norast.pdf}
  \column{0.037\textwidth}\centering\adjustbox{valign=c}{\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/horaire/compare_5/sat_99.0/legend.pdf}}
  \column{0.31\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/horaire/compare_5/sat_99.0/hydro/obs_norast_diff.pdf}
  \column{0.04\textwidth}\centering\includegraphics[width=\linewidth]{../outputs/maps/stats_mean-max/horaire/compare_5/sat_99.0/legend_diff.pdf}
\end{columns}

r = `{python} f'{df_mean_max_pluie_horaire['r'].iloc[0].item():.2f}'` \newline
Δ (AROME - Stations) de 1990 à 2022 : `{python} f'{df_mean_max_pluie_horaire['me'].iloc[0].item():+.2f}'` mm/h (`{python} f'{df_mean_max_pluie_horaire['delta'].iloc[0].item():+.2f}'`%) \newline

---

**Moyenne des maximas des précipitations suivant la saison et l'échelle temporelle**

![](../_rapport/figures/histo_mean-max.png){width=100%}


# Bonne distribution et difficulté évènementielle

![](schema/bilan-2.pdf)
